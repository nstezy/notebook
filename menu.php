<?php
// Защита от прямого доступа к файлу
if (!defined('APP')) {
    die('Access denied'); // если константа APP не определена, скрипт завершает выполнение
}

// Функция формирования меню и подменю для навигации
function menu(): string
{
    // Определяем текущее действие из GET-параметра (по умолчанию 'view')
    $action = $_GET['action'] ?? 'view';

    // Определяем текущую сортировку (используется для подменю, по умолчанию 'created')
    $sort = $_GET['sort'] ?? 'created';

    // Переменная для хранения HTML-кода меню
    $html = '';

    // Основное меню — это главные действия, которые может выбрать пользователь
    $items = [
        'view' => 'Просмотр',              // отображение списка записей
        'add' => 'Добавление записи',      // форма добавления новой записи
        'edit' => 'Редактирование записи', // форма редактирования существующей записи
        'delete' => 'Удаление записи'      // удаление выбранной записи
    ];

    // Формируем HTML для основного меню
    foreach ($items as $k => $label) {
        // Если текущее действие совпадает с этим пунктом, добавляем класс 'active'
        $activeClass = ($action === $k) ? ' active' : '';
        // Добавляем ссылку на действие в меню
        $html .= '<a class="menu-btn' . $activeClass . '" href="?action=' . $k . '">' . $label . '</a>';
    }

    // Подменю сортировки отображается только если текущее действие — просмотр
    if ($action === 'view') {
        $html .= '<div class="submenu">'; // контейнер для подменю

        // Опции сортировки для подменю
        $sorts = [
            'created' => 'По добавлению',   // сортировка по дате добавления
            'lastname' => 'По фамилии',     // сортировка по фамилии
            'dob' => 'По дате рождения'     // сортировка по дате рождения
        ];

        // Генерируем ссылки подменю сортировки
        foreach ($sorts as $sk => $slabel) {
            // Если текущая сортировка совпадает с этой опцией, добавляем класс 'active'
            $activeClass = ($sort === $sk) ? ' active' : '';
            // Добавляем ссылку на сортировку
            $html .= '<a class="sub-btn' . $activeClass . '" href="?action=view&sort=' . $sk . '">' . $slabel . '</a>';
        }

        $html .= '</div>'; // закрываем контейнер подменю
    }

    // Возвращаем сгенерированный HTML код меню
    return $html;
}
